/*! hapify-cli 2019-03-11 */

"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function c(e){try{a(n.next(e))}catch(e){o(e)}}function s(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(c,s)}a((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const typedi_1=require("typedi"),service_1=require("../service"),helpers_1=require("./helpers"),options=typedi_1.Container.get(service_1.OptionsService),logger=typedi_1.Container.get(service_1.LoggerService),http=typedi_1.Container.get(service_1.HttpServerService),channelsService=typedi_1.Container.get(service_1.ChannelsService);function ServeCommand(e){return __awaiter(this,void 0,void 0,function*(){try{options.setCommand(e),yield channelsService.ensureSameProject(),yield channelsService.ensureSameDefaultFields(),yield http.serve(),logger.info(`Server is running at: ${helpers_1.cPath(http.url())}`),options.open()&&http.open(),logger.time()}catch(e){logger.handle(e)}})}exports.ServeCommand=ServeCommand;