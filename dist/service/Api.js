/*! hapify-cli 2019-03-03 */

"use strict";var __decorate=this&&this.__decorate||function(t,e,r,i){var o,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(o,s){function n(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(n,a)}c((i=i.apply(t,e||[])).next())})},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const typedi_1=require("typedi"),axios_1=__importDefault(require("axios")),querystring_1=__importDefault(require("querystring")),Options_1=require("./Options");class RichAxiosError{constructor(t){this.name="RichAxiosError",this.stack=t.stack,this.config=t.config,this.code=t.code,this.request=t.request,this.response=t.response,t.response&&t.response.data?(this.message=t.response.data.message,this.data=t.response.data.data):this.message=t.message}}exports.RichAxiosError=RichAxiosError;let ApiService=class{constructor(t){this.optionsService=t,this.http=axios_1.default.create({baseURL:this.optionsService.remoteConfig().uri,headers:{"X-Api-Key":this.optionsService.apiKey()}})}get(t,e,r){return __awaiter(this,void 0,void 0,function*(){try{return yield this.http.get(this.query(t,e),r)}catch(t){throw new RichAxiosError(t)}})}post(t,e,r,i){return __awaiter(this,void 0,void 0,function*(){try{return yield this.http.post(this.query(t,r),e,i)}catch(t){throw new RichAxiosError(t)}})}patch(t,e,r,i){return __awaiter(this,void 0,void 0,function*(){try{return yield this.http.patch(this.query(t,r),e,i)}catch(t){throw new RichAxiosError(t)}})}delete(t,e,r){return __awaiter(this,void 0,void 0,function*(){try{return yield this.http.delete(this.query(t,e),r)}catch(t){throw new RichAxiosError(t)}})}query(t,e){return e?`${t}?${querystring_1.default.stringify(e)}`:t}};ApiService=__decorate([typedi_1.Service(),__metadata("design:paramtypes",[Options_1.OptionsService])],ApiService),exports.ApiService=ApiService;