/*! hapify-cli 2019-03-07 */

"use strict";var __decorate=this&&this.__decorate||function(e,t,r,i){var n,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{s(i.next(e))}catch(e){a(e)}}function c(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(o,c)}s((i=i.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const typedi_1=require("typedi"),Api_1=require("./Api");let GeneratorService=class{constructor(){}api(){return void 0===this.apiService&&(this.apiService=typedi_1.Container.get(Api_1.ApiService)),this.apiService}limits(){return __awaiter(this,void 0,void 0,function*(){return this._limits||(this._limits=(yield this.api().get("generator/limits")).data),this._limits})}runChannel(e){return __awaiter(this,void 0,void 0,function*(){return(yield this.api().post("generator/run",{project:e.config.project,templates:e.templates.map(e=>e.toObject())})).data.results})}runTemplate(e){return __awaiter(this,void 0,void 0,function*(){return(yield this.api().post("generator/run",{project:e.channel().config.project,templates:[e.toObject()]})).data.results})}run(e,t){return __awaiter(this,void 0,void 0,function*(){if(e.needsModel()&&!t)throw new Error("Model should be defined for this template");const r={project:e.channel().config.project,templates:[e.toObject()]};return t&&(r.ids=[t.id]),(yield this.api().post("generator/run",r)).data.results[0]})}pathPreview(e,t=null){return __awaiter(this,void 0,void 0,function*(){const r=t?{path:e,model:t.id}:{path:e};return(yield this.api().post("generator/path",r)).data.result})}};GeneratorService=__decorate([typedi_1.Service(),__metadata("design:paramtypes",[])],GeneratorService),exports.GeneratorService=GeneratorService;